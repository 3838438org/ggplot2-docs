<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stack overlapping objects on top of one another. — position_stack • ggplot2</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- tidyverse -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">ggplot2</a>
        <small class="tidyverse">part of the <a href="http://tidyverse.org">tidyverse</a></small>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/hadley/ggplot2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stack overlapping objects on top of one another.</h1>
    </div>

    
    <p><code>position_stack()</code> stacks bars on top of each other;
<code>position_fill()</code> stacks bars and standardises each stack to have
constant height.</p>
    

    <pre><span class='fu'>position_stack</span>(<span class='kw'>vjust</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>reverse</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>position_fill</span>(<span class='kw'>vjust</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>reverse</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>vjust</dt>
      <dd>Vertical adjustment for geoms that have a position
(like points or lines), not a dimension (like bars or areas). Set to
<code>0</code> to align with the bottom, <code>0.5</code> for the middle,
and <code>1</code> (the default) for the top.</dd>
      <dt>reverse</dt>
      <dd>If <code>TRUE</code>, will reverse the default stacking order.
This is useful if you&#39;re rotating both the plot and legend.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>position_fill()</code> and <code>position_stack()</code> automatically stack
values in reverse order of the group aesthetic, which for bar charts is
usually defined by the fill aesthetic (the default group aesthetic is formed
by the combination of all discrete aesthetics except for x and y). This
default ensures that bar colours align with the default legend.</p>
    <p>There are three ways to override the defaults depending on what you want:</p>
    <p><ol>
<li> Change the order of the levels in the underyling factor. This
    will change the stacking order, and the order of keys in the legend.</p>
    <p></li>
<li> Set the legend <code>breaks</code> to change the order of the keys
    without affecting the stacking.</p>
    <p></li>
<li> Manually set the group aesthetic to change the stacking order
    without affecting the legend.
</li>
</ol></p>
    <p>Stacking of positive and negative values are performed separately so that
positive values stack upwards from the x-axis and negative values stack
downward.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>See <code><a href='geom_bar.html'>geom_bar</a></code> and <code><a href='geom_ribbon.html'>geom_area</a></code> for
  more examples.</p>
    <p>Other position adjustments: <code><a href='position_dodge.html'>position_dodge</a></code>,
  <code><a href='position_identity.html'>position_identity</a></code>,
  <code><a href='position_jitterdodge.html'>position_jitterdodge</a></code>,
  <code><a href='position_jitter.html'>position_jitter</a></code>,
  <code><a href='position_nudge.html'>position_nudge</a></code></p>
    

    <h2 class="hasAnchor" id="examples">
      <a class="anchor" href="#examples"></a>
      Examples
    </h2>
    <pre class="examples"><div class='input'><span class='co'># Stacking and filling ------------------------------------------------------</span>

<span class='co'># Stacking is the default behaviour for most area plots.</span>
<span class='co'># Fill makes it easier to compare proportions</span>
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>mtcars</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='fu'>factor</span>(<span class='no'>cyl</span>), <span class='kw'>fill</span> <span class='kw'>=</span> <span class='fu'>factor</span>(<span class='no'>vs</span>))) +
  <span class='fu'><a href='geom_bar.html'>geom_bar</a></span>()</div><img src='position_stack-2.png' alt='' width='540' height='400' /><div class='input'><span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>mtcars</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='fu'>factor</span>(<span class='no'>cyl</span>), <span class='kw'>fill</span> <span class='kw'>=</span> <span class='fu'>factor</span>(<span class='no'>vs</span>))) +
  <span class='fu'><a href='geom_bar.html'>geom_bar</a></span>(<span class='kw'>position</span> <span class='kw'>=</span> <span class='st'>"fill"</span>)</div><img src='position_stack-4.png' alt='' width='540' height='400' /><div class='input'>
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>diamonds</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>price</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>cut</span>)) +
  <span class='fu'><a href='geom_freqpoly.html'>geom_histogram</a></span>(<span class='kw'>binwidth</span> <span class='kw'>=</span> <span class='fl'>500</span>)</div><img src='position_stack-6.png' alt='' width='540' height='400' /><div class='input'><span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>diamonds</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>price</span>, <span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>cut</span>)) +
  <span class='fu'><a href='geom_freqpoly.html'>geom_histogram</a></span>(<span class='kw'>binwidth</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>position</span> <span class='kw'>=</span> <span class='st'>"fill"</span>)</div><img src='position_stack-8.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># Stacking is also useful for time series</span>
<span class='no'>series</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(
  <span class='kw'>time</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fu'>rep</span>(<span class='fl'>1</span>, <span class='fl'>4</span>),<span class='fu'>rep</span>(<span class='fl'>2</span>, <span class='fl'>4</span>), <span class='fu'>rep</span>(<span class='fl'>3</span>, <span class='fl'>4</span>), <span class='fu'>rep</span>(<span class='fl'>4</span>, <span class='fl'>4</span>)),
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fu'>c</span>(<span class='st'>'a'</span>, <span class='st'>'b'</span>, <span class='st'>'c'</span>, <span class='st'>'d'</span>), <span class='fl'>4</span>),
  <span class='kw'>value</span> <span class='kw'>=</span> <span class='fu'>rpois</span>(<span class='fl'>16</span>, <span class='fl'>10</span>)
)
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>series</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>time</span>, <span class='no'>value</span>)) +
  <span class='fu'><a href='geom_ribbon.html'>geom_area</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>type</span>))</div><img src='position_stack-10.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># Stacking order ------------------------------------------------------------</span>

<span class='co'># You control the stacking order by setting the levels of the underlying</span>
<span class='co'># factor. See the forcats package for convenient helpers.</span>
<span class='no'>series</span>$<span class='no'>type2</span> <span class='kw'>&lt;-</span> <span class='fu'>factor</span>(<span class='no'>series</span>$<span class='no'>type</span>, <span class='kw'>levels</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>'c'</span>, <span class='st'>'b'</span>, <span class='st'>'d'</span>, <span class='st'>'a'</span>))
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>series</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>time</span>, <span class='no'>value</span>)) +
  <span class='fu'><a href='geom_ribbon.html'>geom_area</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>type2</span>))</div><img src='position_stack-12.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># You can change the order of the levels in the legend using the scale</span>
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>series</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>time</span>, <span class='no'>value</span>)) +
  <span class='fu'><a href='geom_ribbon.html'>geom_area</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>type</span>)) +
  <span class='fu'><a href='scale_colour_hue.html'>scale_fill_discrete</a></span>(<span class='kw'>breaks</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>'a'</span>, <span class='st'>'b'</span>, <span class='st'>'c'</span>, <span class='st'>'d'</span>))</div><img src='position_stack-14.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># Non-area plots ------------------------------------------------------------</span>

<span class='co'># When stacking across multiple layers it's a good idea to always set</span>
<span class='co'># the `group` aethetic in the ggplot() call. This ensures that all layers</span>
<span class='co'># are stacked in the same way.</span>
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>series</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>time</span>, <span class='no'>value</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>type</span>)) +
  <span class='fu'><a href='geom_path.html'>geom_line</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>colour</span> <span class='kw'>=</span> <span class='no'>type</span>), <span class='kw'>position</span> <span class='kw'>=</span> <span class='st'>"stack"</span>) +
  <span class='fu'><a href='geom_point.html'>geom_point</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>colour</span> <span class='kw'>=</span> <span class='no'>type</span>), <span class='kw'>position</span> <span class='kw'>=</span> <span class='st'>"stack"</span>)</div><img src='position_stack-16.png' alt='' width='540' height='400' /><div class='input'>
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>series</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>time</span>, <span class='no'>value</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>type</span>)) +
  <span class='fu'><a href='geom_ribbon.html'>geom_area</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>type</span>)) +
  <span class='fu'><a href='geom_path.html'>geom_line</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>type</span>), <span class='kw'>position</span> <span class='kw'>=</span> <span class='st'>"stack"</span>)</div><img src='position_stack-18.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># You can also stack labels, but the default position is suboptimal.</span>
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>series</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>time</span>, <span class='no'>value</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>type</span>)) +
  <span class='fu'><a href='geom_ribbon.html'>geom_area</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>type</span>)) +
  <span class='fu'><a href='geom_label.html'>geom_text</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>label</span> <span class='kw'>=</span> <span class='no'>type</span>), <span class='kw'>position</span> <span class='kw'>=</span> <span class='st'>"stack"</span>)</div><img src='position_stack-20.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># You can override this with the vjust parameter. A vjust of 0.5</span>
<span class='co'># will center the labels inside the corresponding area</span>
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='no'>series</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>time</span>, <span class='no'>value</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>type</span>)) +
  <span class='fu'><a href='geom_ribbon.html'>geom_area</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>type</span>)) +
  <span class='fu'><a href='geom_label.html'>geom_text</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>label</span> <span class='kw'>=</span> <span class='no'>type</span>), <span class='kw'>position</span> <span class='kw'>=</span> <span class='fu'>position_stack</span>(<span class='kw'>vjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><img src='position_stack-22.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'># Negative values -----------------------------------------------------------</span>

<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='kw'>tibble</span><span class='kw'>::</span><span class='fu'>tribble</span>(
  ~<span class='no'>x</span>, ~<span class='no'>y</span>, ~<span class='no'>grp</span>,
  <span class='st'>"a"</span>, <span class='fl'>1</span>,  <span class='st'>"x"</span>,
  <span class='st'>"a"</span>, <span class='fl'>2</span>,  <span class='st'>"y"</span>,
  <span class='st'>"b"</span>, <span class='fl'>1</span>,  <span class='st'>"x"</span>,
  <span class='st'>"b"</span>, <span class='fl'>3</span>,  <span class='st'>"y"</span>,
  <span class='st'>"b"</span>, -<span class='fl'>1</span>, <span class='st'>"y"</span>
)
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>df</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>grp</span>)) +
  <span class='fu'><a href='geom_col.html'>geom_col</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>grp</span>), <span class='kw'>position</span> <span class='kw'>=</span> <span class='fu'>position_stack</span>(<span class='kw'>reverse</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)) +
  <span class='fu'><a href='geom_abline.html'>geom_hline</a></span>(<span class='kw'>yintercept</span> <span class='kw'>=</span> <span class='fl'>0</span>)</div><img src='position_stack-24.png' alt='' width='540' height='400' /><div class='input'>
<span class='fu'><a href='ggplot.html'>ggplot</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>df</span>, <span class='fu'><a href='aes.html'>aes</a></span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>grp</span>)) +
  <span class='fu'><a href='geom_col.html'>geom_col</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>fill</span> <span class='kw'>=</span> <span class='no'>grp</span>)) +
  <span class='fu'><a href='geom_abline.html'>geom_hline</a></span>(<span class='kw'>yintercept</span> <span class='kw'>=</span> <span class='fl'>0</span>) +
  <span class='fu'><a href='geom_label.html'>geom_text</a></span>(<span class='fu'><a href='aes.html'>aes</a></span>(<span class='kw'>label</span> <span class='kw'>=</span> <span class='no'>grp</span>), <span class='kw'>position</span> <span class='kw'>=</span> <span class='fu'>position_stack</span>(<span class='kw'>vjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><img src='position_stack-26.png' alt='' width='540' height='400' /></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="tidyverse">
  <p>ggplot2 is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="http://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>Developed by <a href='http://hadley.nz'>Hadley Wickham</a>, Winston Chang.</p>
  <p>Site built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>
      </footer>
   </div>

  </body>
</html>
